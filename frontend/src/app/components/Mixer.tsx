import axios from "axios";
import { useEffect, useState } from "react";
import {
  useAccount,
  useWaitForTransactionReceipt,
  useWriteContract,
} from "wagmi";
import {
  BACKEND_API,
  ETH_DENOMINATION,
  SEPOLIA_EXPLORER,
  ZK_MIXER_CONTRACT,
} from "../utils/contants";
import Link from "next/link";
import { abi } from "../../contractData/abi";
import { generateProof } from "../utils/generateProof";
import { convertProofToBytes } from "../utils";
import { Barretenberg } from "@aztec/bb.js";
import { Fr } from "@aztec/bb.js";
import { simulateContract } from "wagmi/actions";
import { config } from "@/config";
import { BaseError } from "viem";

interface CustomError extends BaseError {
  cause?: {
    details?: string;
  };
}

export default function Mixer() {
  const [encodedProof, setEncodedProof] = useState<string>();
  const [isWithdraw, setIsWithdraw] = useState(false);
  const [copied, setCopied] = useState(false);
  const [note, setNote] = useState("");
  const [withdrawErrMsg, setWithdrawErrMsg] = useState("");
  const [depositErrMsg, setDepositErrMsg] = useState("");
  const [proofGenerationInfo, setProofGenerationInfo] = useState("");
  const [commitment, setCommitment] = useState("");
  const { writeContractAsync, isPending, error, data } = useWriteContract();
  const { chainId, address } = useAccount();
  let barratenberg: Barretenberg;
  const {
    isLoading: isConfirmaing,
    isSuccess: isConfirmed,
    error: txError,
  } = useWaitForTransactionReceipt({
    hash: data,
  });

  useEffect(() => {
    if (isConfirmed && commitment) {
      // push commitment to backend
      axios
        .post(`${BACKEND_API}/mixer/api/deposit`, {
          commitment,
        })
        .then((res) => console.log(res.data))
        .catch((err) => console.error(err));
      setCommitment("");
    }
  }, [commitment, isConfirmed]);

  async function handleDeposit() {
    const nullifier = Fr.random();
    const secret = Fr.random();
    if (!barratenberg) {
      barratenberg = await Barretenberg.new({ threads: 1 });
    }
    const commitment = await barratenberg.poseidon2Hash([nullifier, secret]);
    setCommitment(commitment.toString());

    // ProtocolName-tokenName-denomination-networkdId-Nullifier-Secret
    setNote(
      `ZkMixer-eth-${ETH_DENOMINATION}-${chainId}-${nullifier}-${secret}`
    );

    const writeContractInfo = {
      abi,
      address: ZK_MIXER_CONTRACT as `0x${string}`,
      functionName: "deposit",
      args: [commitment.toString()],
      value: BigInt(ETH_DENOMINATION),
    };

    try {
      const simulationResponse = await simulateContract(
        config,
        writeContractInfo
      );
      console.log({ simulationResponse });
    } catch (err) {
      setDepositErrMsg("Failed to simulate transaction");
      console.error(err);
    }

    try {
      await writeContractAsync(writeContractInfo);
    } catch (err) {
      console.error(err);
    }
  }

  function handleCopy() {
    try {
      navigator.clipboard.writeText(note);
      setCopied(true);
    } catch (err) {
      console.error(err);
    }
  }

  async function handleWithdraw() {
    setProofGenerationInfo("generating proof...");
    const decodedProof = encodedProof?.split("-");
    if (!decodedProof || !address) {
      setWithdrawErrMsg("Please enter the encoded proof");
      return;
    }
    const nullifier = decodedProof[decodedProof.length - 2];
    const secret = decodedProof[decodedProof.length - 1];
    if (!barratenberg) {
      barratenberg = await Barretenberg.new({ threads: 1 });
    }

    const commitment = await barratenberg.poseidon2Hash([
      Fr.fromString(nullifier),
      Fr.fromString(secret),
    ]);

    const nullifierHash = await barratenberg.poseidon2Hash([
      Fr.fromString(nullifier),
    ]);

    // backend
    const leaves = (await axios
      .get(`${BACKEND_API}/mixer/api/withdraw`)
      .then((res) =>
        res.data.map((d: { commitment: string }) => d.commitment)
      )) as string[];

    // indexer
    // const leaves = await axios
    //   .post(
    //     "http://localhost:3001/graphql",
    //     {
    //       query: `
    //       query AllDeposits($orderBy: [DepositsOrderBy!]) {
    //         allDeposits(orderBy: $orderBy) {
    //           nodes {
    //             commitmennt
    //           }
    //         }
    //       }
    //     `,
    //       variables: {
    //         orderBy: "BLOCK_NUMBER_ASC",
    //       },
    //     },
    //     {
    //       headers: {
    //         "Content-Type": "application/json",
    //       },
    //     }
    //   )
    //   .then((res) => res.data)
    //   .then((graphqlRes) => {
    //     const finalOutput = graphqlRes.data.allDeposits.nodes.reduce(
    //       (acc: string[], node: { commitmennt: string }) => {
    //         acc.push(node.commitmennt);
    //         return acc;
    //       },
    //       []
    //     );
    //     return finalOutput;
    //   });
    // const leaves = [
    //   "0x2a2f73526fcedf30b91bca5827679ce48d024753b2ca06217b99479c8f9911c1",
    //   "0x22b32ba4fdaddc6c212496febb78575d054ace0985a130df298c953634d2a803",
    //   "0x079cd038fb75ec74807b3efadefbd486c26c4707aff68b67261cbd795bb1fa3b",
    //   "0x0acf7635d83ae55448dd29af15a69364320f30bd853a4d6b20a05304d706bb32",
    //   "0x03f9e89ac3c5743507a37b33a7139eadb9b85815b815692d986ee57ee7557c14",
    //   "0x1a800b94519f17f22091ea1e84c6a23a1fba40808bbd3762b079ad0a4bac20ba",
    //   "0x29da70e2e2917fae8238f4ca50992e680032f84d295355acf86349870f25f043", // used
    //   "0x1c1caecb62347cc5a32cecc21bf80ff51c04d57f658f6e2faf711dfa9233c61d", // used
    //   "0x2c88a37b7eef3ee2ca048c1434eb9b160df0eed408c534264e145e8471992c4e", // used
    // ];

    const { proof, merkleRoot } = await generateProof({
      leaves,
      receipient: address,
      commitment: commitment.toString(),
      nullifierHash: nullifierHash.toString(),
      nullifier,
      secret,
      setWithdrawErrMsg,
      setProofGenerationInfo,
    });

    // // for note8 - test
    // const testArguments8 = [
    //   "0x000000000000000000000000000000606e42a66ceff44e02c3019c14acb49a1900000000000000000000000000000000001c8b69c359181b67289577a164cd26000000000000000000000000000000852405ddbaa7b5c54df6e70f2eaa8f99180000000000000000000000000000000000009e81958d177a3455f80d005b278c000000000000000000000000000000641241eb28569676c92d44f985caa4d661000000000000000000000000000000000018b56a66a71f0c8b63faf64738d07e000000000000000000000000000000252b3d08a7c17cbe232b35f1aa0161e8da0000000000000000000000000000000000236e6057b7b7f1d476b1a2e97508550000000000000000000000000000002d94a5661441b68c001d94bdaf6658e57e000000000000000000000000000000000018796f2e9f3e0b848eb3d0ff5b72b8000000000000000000000000000000d20f4b6d9e370137d353ae7e67af4cd0620000000000000000000000000000000000014cc285c04dcc54033564f50b489d0000000000000000000000000000003efeb5c04e1e842fe2e99d986d077318a60000000000000000000000000000000000220a16cb10c33d7825da201ae19e2c000000000000000000000000000000b3f781c6ebbde829c5509fd1b7b82c3bee00000000000000000000000000000000001649b837dc92371f06e43182edcbe20000000000000000000000000000003efeb5c04e1e842fe2e99d986d077318a60000000000000000000000000000000000220a16cb10c33d7825da201ae19e2c000000000000000000000000000000b3f781c6ebbde829c5509fd1b7b82c3bee00000000000000000000000000000000001649b837dc92371f06e43182edcbe2000000000000000000000000000000b7224f870b17cd24ca234796af5877e0b300000000000000000000000000000000000629bb2869e1bd7d3f975e46e0b7f70000000000000000000000000000009e7eb3015376dcc9a1beba192f94fededa00000000000000000000000000000000002f1b91aefec3ded07a7d81770ad9f4000000000000000000000000000000aecf30c7002281767c35e24904925ff89b000000000000000000000000000000000001e8316665f443568ada479ccbf025000000000000000000000000000000f61bdfc57c84939c2392369e7ce611e985000000000000000000000000000000000011b7554a8195026760fd35e256a29600000000000000000000000000000063f3ba0da462ab7e9ceee2015eae2fa7d8000000000000000000000000000000000015913c7f6eadaaebe57654d319a9e6000000000000000000000000000000a992d84d28e800f6ae1099e12c9fe58bfb000000000000000000000000000000000011397d31d120369e2473b7622ff0611b19a805a95f1a47bdb500671a3bdb3e004fba6b692c5e351f4c5823aca4add5154aa66d37d285e1fa9b454f67457d1f27e42ddd108d125c24959d70435b522c2abef36b4d730a693dd489d4bbc65c28f5effb3ad5258c61cfc4d2a845d89382029970ff79891faf1fe6fd57b5b9fc3eadc63b96e9bd24058ff3342e7d37f7e7284504e6b25a9811f247f18135b4f40de06a4df48c9ffc31f4179954b110aca300bf742ce0ac17fe6de65daccc71e5a8729fab16c6dd669964b86bf8d9304eab14b64688b7e6cb75b962d6940b473da1acec9844590061d39c94bb342d35b482251d660dc8460da59a05cd1f23a06a15bb02199e16fcbb06b2082fbd2f79d59528594891be3479a9c4a4c9669994f0575c376e6ba028ccb9feed7efdc760e8b80007171ba60308944af1572a0b93d71d301701d746df8dac4db0817a04c5faf01e0f7b5060c95b4bf34ce11c27f0b02aa272d646c5795de0545af0e24e04ce580e6e7c038df8cbe0cd4a16fbe118489bf3e59755c5164a59dbebd81372241f0021906eea4a5e556935f7aaaf386c18a0ca50f6056b9556e6d3481ab9687a9a030014a37820e77c8c4b88da0fb36bb5a0735a4de1f675b4fd149cf8a5e28160f71099a3a9fc16833cea70d38047f95dd46c91cba6d7d911daa1ae05bda030acbb04e6eb447bc78b4239968d5e56ec8028f0d3df65b51586cbb8a765a0eb62b54620a9a45df0a53bee3b34a2728ad8be0f5aaa3c305f22b9a8f9bea7f3676ba0483010c83cb50d81ed1403a8e8646a971e3eece499ae505ab340042be8479815a7060d67567d85db7193735e718ba1a0d584914938732665271d128f523fd895f727d8115364ecbed4201b2695257a8fbe0e219fcb97871ae0bf37b39043dbbafe1f1173f0a47c083d49f9982d1950058edfc4ba16c85bf19232003bfe11462b4006fa07290ca3bb452be87a83115119f1274a6b024cb717d570023da4e370551c3024d6fdfdf615643d006ca16c2dda0a3986072dde56dacc1becfed650dae50e1d870f2e7b67bf1873311820888b2fc1cd39df10b8d9d08d921311805b515476199e497357247fe5f3ede353d5f507d0ee5addce384dac45d779e86c2234f5b5166ef1f08f7140e92e35253f87b8c29dd2fa95a3302f8136eb39a90f3843fed908d4de8b19477dbb3eca5684196143d5055be7000f8e37bc97d6eaf0a52bd0580fda47dbdcfff1699e17565fbdd83ebeaf3f15f32dca9d4631e9350c01916103265b9fab5744a8a42e1b02a948ac0590f08134484b3c15ec8df2c04ebc3e29230d3baf2b422ece266456b18933c0a1d21f64de529cb2ea9497a3325a5b7612cd0d705df9bac927b05fc36bb795619f2d4d3e03664578c0e158796723dccfce8e1c422000266ba0dd1633040f30ab031ff29c27bc26bb0b87b242e62734a68b84020a86da0a9e01ff84c842af11265b93ecddea33c4aa9a6693ac11c8365e83e22eccc3a6fde4b9d6e79f03175b102b3f1b78c32fa6491f656df6b01ccba399e2026f8860647acb6774ab2126f1ab28222ddbea0466a8304e347f44918dc1020f19234422b8a9b95dcb361488dab6b2c69224793518ab4277ea5bb5d0d7d1a8380eda7cd8b73b15cede3dfac52f89a3dfdd88186e52413b4a656b74bc7effa12c2246c60eb084f6c5e4c46551bc2a784a1cb5d8294405b4434a8f9189481754210eeecbe2223db5e442a3a221ea912986f9759f18d9df0c93a17a05c6262b9ae116544aaa9961dad187e410c517d24fabe254d35a4cf27436f2b8c11724c3f6330c65060ed29bc2d0128762008188e761f6c4fe1ea4590ac30774c714cf83a0a513f53e7aec46776a87edb0839eb86de49455998cda4a70c5d1a6a530aa0c968924143937111a54181999a4c3f0a51723e0fb629fcc0d4b83646b43f4b803ea3f12b0896394a361e21b7578af28ecdf778bbfd7558a6bf9d8dcadb669dbddb0f8080a580a7c713262e91744c875404c1a0d46cea0022614ba1eeb6963f769de1a0a9a829deea71df70dd5e44c57a3e4d2b7501379208af97b501fd1022255f803039da56a6210c846825cf911975116ab5de315165061fc65d861e2f5d7b99da212c1a0d4ccde6118ebdc099fd478c33ef4e661b3e176db973644fc8182f0aeb828f4bcfac3b3cb3f90c00ea7e339d9098682e233ba9e76a668ea066567b2c8131a5a8eec89f9954a0aa031134e07a54c824b97b87c62069aaab97e30b974ae3f1c0402e38182a95c52adc4e52776eb1be6d0ef20989d0ba65f8c70a0a01cacdf1990cf3a21c4ba1631c4b9e4267bef5a38a6f0603900e1e891392c6705ca89ff179905102c47f5cd3c4dda643e8c5f4cfb15206e0f6211fdbbfb1827d9a5af1f1ce3cc41b784f90796d7dae84978bbf9227b3cc6fdd1818d112ecd747ec8052506cec67c4366ec94563a58390093020e547d1010bfbee90a58593e4455affb970da0795dfa7a0fd83cecf1fa690219ed88e065a1603e9461e6c18839d454c27d0df502cc9fe8928b28da598e06f4b775f704af0f4d0423ab1ad2441aec87f552145298416ba73b860d854f106f6dc750c0083e4592e709a24506e983d59cfb560f73245adcdbb175090766392c8942f90a7894bc284656431fae516fac3c8c23229b92d927b0557e8473f9fd282e601f57dabdc9b634c34e1affa3ee01e9c93a0fd2daa53aff462c3057c81e8d698ee06cce3ee4c6f5943d6d8b09d3a8312bdd0b0d13555ce394ae92e5cbb791d8906fa88e9e7209a1b07fe7bb204fd035b98f0f3a09a61f286998b2ceccf1c4997262a446fee6bac9bfcbb0458cd47fbe9b7612fa7f609868ce725696f37370d0b127af1ed0947edcae40c5fceff524cc89c107964d71dab230ff14a908256f5867b7a48e8b32fb956eeee8f09df93d5a5f761d38217878fe25091a12b7843e39d8b83c4b31033e7646dc6ad9559b56853c572379608902c07bc3122b7526e05ecdfa8dc6d980fb4a736aff10079daeba943d0242d195d6907c98c6412336d03a1f90654d4164fb6512764ecb42058d87ee5d20d397b92469d0e4259c5a4e8373c042da911ee9e16baaa312f874a7289a409408960c7a86ed99c23e36b28d6a511067a0dbf2f326001af7e7ee22deaa6a30001a357e5b11965dcc8367c2603265ce818fbc55cab3011a886849d9fa7a75e5270e464a5e36ef20a91cb9123d4b3560a8826ca7d815b655d29cf9eb9b6072e6c312f40f8b11449cc8da4211a02feea493d4bf290eaafbc2616fefebaf8d32eba01bc20f1fa217ce11f42de6ac939f3e693476cd73472439fd98b761eabe16734125915cf3cc8010064f898c9d2121b20bd17a84bbd15a465c90331affa118271128f6db7bcfb2d7f788c777b9d6c7522dd172d978d9836d8c9ba876181864fcad1ab6170674bdee70f03ce76f65da30dd7a54ecfe31f0eabb5d676b7dffc8485f0a025acae2adfaafc464c6df60490d2eba89ca6692548f37284243a8cc5ef0eb13924c3931c59936bd6f60de1d7e45262158a3734f56c4f58aa810c8f17058b00cd1d8fba218f127d6ef74ed87fe73dcd45536e68a36823180b1325f7fae45f901b9585597823f4c3c1b11505e8c1fef113389930771ba31864f31554216c5c30a3d277cbb759c2ac54101d08524ed46862face5c954dd81b11ed598b821b54b09032d199c48d5785e59dc11f5904ff8a9c5be6b6a7d94c49da169556491d4f90c90c7d289afb1e5d195fba3b7815779f9bfa485bbd940db62c825ccf9b2414029c41b8fcc1b85062b921b395e4239d4ee718c7916c150b91e05ab2c0a6c24242619411dc6ac539a7eacfee4caa93960ab30b0411248fdef2ef9b1b327fd974e23531c7405c1b39daaf85e692acd2edfe9e8998b91552e22a09693ab6e8703ec301e4b1b96a9c69356a12f73da017e3e1fd2de5ba70496f22b422727f41bbe060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000217eed3870076cddfe3f28d3fa6d06c8334f24318ce5759d8815bb62fc175f240ff04fcb675b34ba043ff69cbac9ccafd2283f0881c9d31979a8d24ac59fbb610956a2298c6ec0977b3cedfd57f852ec2b8b7cfcbdbd877fee7117678f4f3b48141697f9cbd408af00e66405d7dcd8fcd47c918ac42e60ab95fbe42ef3f70df1049aeb769e4ff9f20d0c9504168e6d65a332d8986ad092bdd1c801fb4c428f63091aef8af446246bb4db28eb715701d2ff2d1b411a3fdfd504c55b6045bf6e630c7a751dc64579cc46e9f96b9102db13d1d43f91dff78699c93fef5aceeea1382fcd145f7e7fd7e26df9bcf268b53664ff0c017eba127095050061a1e3b0c4110f6ab981990f5e21ac173fbff6c3a61f964e36454a891b345aadb972b17103ed1debb54497613a2e7f57f5495b6909579995be1b1f4033c9ce81ee885af11028084de17e369345a4c4faef52b1268f410fae7473d049eb723f1812cfb099100519b3c31d23ee4bd9069860a9c5b2c8384af07e56de601f9e740cd3dc29d3dba51e29ecd697119ad3ee9d6b23964e014fd46304d760c9ab9f8b1005b8f1ea5c2f1a1e0274490c4020d2ccfb4043c1f95bfcff27cc9349ff9bc186a824a3f89f4f17d76e144b35b6806028c0d5237c86ff968e057e1aca6389c7e1efdf96aebd7503af28f0ffcf4fe9e49b08917809371549982cf93051a767b48fceeb5c5bda6e0252104b351926ae8c454c632db615b87668446b0a44cb757da4adbc392a51df12f7eccbb0464be1edb8e9f95641f784e06eea1550bb53f9164003009e343260041e521a32c68f9b1e60ac5f09d00cb9783a855b5eb07901c0331cfbbc4b440d0e12d7c2dd4633db8e7d80c875ce6e8441343aaf78caf15a9902b91e2c344b9d1d5b41eedfad3a754e16935965a2b021beb0c1e5d8dc68f1b83e191bb6aaa96d06c08e2c0030ff35c95eedd35e606eac757eebb57f143f25941fe744d5675a3d2e4d719be5512720b8e8f65b4f128074d4a8d8dfa005aa88407652c766681a7c032a7aa3ad56a8be43578c0ffc33a11bfc8cb5642d815e50e2708e8da06f2ef6117f574b53f9640825a2fb76dcd768ac877c2a3c8f923fa586f4aceb0b1a1e8218384501fc75fb04bdc4b444678597f152eff4d52eef6bd0c8f6e055db4c6ac0255bc89ff30223f9de3067981d300cbe7d0773d5e0ccf8c42968e46488b2df072d89dde673e3a7b0c91cf958e9d6920b4c446787d3d797d2ddf5873c62006cc80582d8720857dfb7ba5c8e4bc56a0c620bf3beb7624144abf04b613bb5337cac0a6454db4701a28fc989465a248ca73da927b6d9a2dff33b5050bbf3e199495d1b89116b74407516ddb9c6c7d7e3841d667341e0b9faa782508ba1227d4cd2471c9cb77b16662b15b2923e562361fe184cfcdd3e167874d9916de0abc3b6b24819a479f7199ebc9dce59cc11e73a225b3e52b269c1d336c044b02c9d40bccb6d0599ef1f1c32d0c64ec214009c01bdb5d50c55e189469c9bff1540cded27ee870599ef1f1c32d0c64ec214009c01bdb5d50c55e189469c9bff1540cded27ee8703dfb3e6073b4c0f7f6607cfe7f6a42a350dc27a95ed8a90ffc6f638cbe0530c24e562568214c2dc69d5816e834ec681891d5a91e7524001ba4c190de1aa7f7d006f90ba22c6ba4f24ffe80c06634d6be903664cb8e2a68b472168b27d28983108a941233fd428be61863d9673e9c5b73fcaa4144939337a76b6dc2a0242c6e006acc509913e264e6e6b96130aa34598d701a34af3e01fcd2144ebe4b99326840000000000000000000000000000005c5672cecfec3facdf40d00078934312fa000000000000000000000000000000000021ca6f02967103eb7c82ec2167ccf1000000000000000000000000000000715f38e6b4ef1bb620ed4a974b8c9638c300000000000000000000000000000000002f1d44a42bf261b749681dec7957880000000000000000000000000000006bc1b8549e7d3aec10bd242e00436760a70000000000000000000000000000000000274c8ed95a9b5685300154b0d7034f00000000000000000000000000000085e2941b5834d98e7cdffff2dfdd4c3688000000000000000000000000000000000027de3c7c2487eaf02bfe625150dd9300000000000000000000000000000084a6230c14cd7555dc90ca468a9e92f49c000000000000000000000000000000000026da2df579ddeb2694d1af307ec4310000000000000000000000000000009aa063db2e8f8364b470938a7c3aa5bc5500000000000000000000000000000000001002fa0948f60cb31448949a69aca900000000000000000000000000000073a8a4ca5ce4ad86afb33251a362a274a300000000000000000000000000000000000ebc2a3c0e98703178c5e4d004cf4200000000000000000000000000000003f6e61d1e380c2c1721814e0092c90b2200000000000000000000000000000000000fc3fa63b5394e9a9610ddddb54c9e00000000000000000000000000000064e9e0b90e87688c9ced76e97de3f627ef00000000000000000000000000000000002c6b7416b7a38a1c243c22ace11fc20000000000000000000000000000005737e346af19134606141341c494fef015000000000000000000000000000000000008023b339e91fde7ad87171c28a1db000000000000000000000000000000a2f24eda0046d915b27c59e8c5fb0ef395000000000000000000000000000000000015c3e220833ba60ed0e43ac30cb55c00000000000000000000000000000004eac76fe760cfa17766348628f4ada7160000000000000000000000000000000000251805148d00d96fe0768710927e990000000000000000000000000000008315b7f632dd9f93d00a8422adb3db9dba00000000000000000000000000000000002e1990011b06a7d5b4b41ae95389b10000000000000000000000000000007994b36ed3f659b133e23a2362f8b9137b0000000000000000000000000000000000181b8ce4aa19e0c1bbe2c9b714fab00000000000000000000000000000005854d7e5fbe4953d6c040e72e517745bd600000000000000000000000000000000001d33b14bd2d0ff4a02f30dad7ccf7e0000000000000000000000000000005f6bd67ba8ec5c2f4f1d873a268cbec08500000000000000000000000000000000002e6d886fa0e3701a15b8d2fd1f82fb0000000000000000000000000000000f32efd0acdaa98d0b96a54d3d1ed28df6000000000000000000000000000000000000b3a64ea03345d5bd34f9278bbef8000000000000000000000000000000bf08ed297a79fa59e8e6dc4b8eaad600cd00000000000000000000000000000000001eecc1456151bbfb9d25a8647d27f00000000000000000000000000000006639e6a0ce9512b3bce6f9e5e9968baf55000000000000000000000000000000000005e7cf604c8176ab27a4b8cd0cad9800000000000000000000000000000073969586d96cc951da8f3612da1e5c3d52000000000000000000000000000000000017f85023a422b21783d941f2e44e14000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000002a9a86e7ac852590347c2ed019f1ec726ef4d7a9665e173e23574afccd4ad540087a2099f9ff5d31afb4c7d33cfe65a43ad77314fe6e304d201bfc83b1675e4d1812e470612013900e732e5accc17e5532746a8de41cf96d4a6244e1c4eda9750b2ae272c31b6d92fd4becde43dc3666b89900cba77fe5f8e7123797801bbde318a0b24c5edbdc390d0a1622e8cd1658cfec7f8491309fe942d99e132d44f6a60470ef336c2f00e0c51a3befa8888d4f3d9aa3fb853c12a395651af80c2574482a92f07e76e5a1ac8377c048a6ee2693117c3896570fb775b866ec6ebcda7ad313a53184a86915733e0d2e3954accb75ccc45b3cc210fc9b2d49e7174a04d13c141ad489ed7d93271df5f7e114265198f89f637f8c1d76ee05ae0d7b42b4cc870839451822e7b25369de5a26cc53eef4dd1b076c52ba6b012c2abb7f1603e460230d0c6e2324c1c744d838d4583895a0fe4ba0d88fd08339cdddb8b7b26227230000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000073a1df85bc5e85591c879205ea002ffd730000000000000000000000000000000000042b37dc0d4bdc7d38bb07a848f993000000000000000000000000000000ce70601b1ea8ac1968bf27fd224f4d8c0800000000000000000000000000000000001760f1d479c31a51c55b0584753d330000000000000000000000000000006b5e5442e947829dd49363a83b16f3286000000000000000000000000000000000000c4149ecaf89b3dca3d2f179ecee2d000000000000000000000000000000df7af2fd7dfa90120f2c85cfcb7dc39df600000000000000000000000000000000002186111abe3efaee7cc67eb767f0aa",
    //   "0x29768a817f409a020e49304cb11c8f6d708d89ab7ce792bfb40717240c47a47e",
    //   "0x06b72c0ec13d56f1d003a50b2092666f3c121dbb919ca1b66a0d9340e8b691a9",
    //   "0xE959A2c1c3F108697c244b98C71803b6DcD77764",
    // ];

    // const testArguments7 = [
    //   "0x000000000000000000000000000000922599d58ef8871e8ef54a5e5582873c23000000000000000000000000000000000000515cf759ebb01ea5adea2260a2b20000000000000000000000000000001af02733f884f512a92a988c2078659eea00000000000000000000000000000000001da33f5c2628e97deca22071edbbac000000000000000000000000000000e3394054851e962a2523917bf6f90bcda800000000000000000000000000000000000817e7debf43bb77a7b75505c431ae0000000000000000000000000000007af13c931dda208c9c6f38e1334f5e0a29000000000000000000000000000000000030046a7901fc843a790a6f29bc3e4a00000000000000000000000000000039d24a7d02bcc8525603ae070a5ecdd0c9000000000000000000000000000000000006e6b244acb445eb49bf3a7f8d7200000000000000000000000000000000cb30cc1fb4860856a60ce583275d79f9f8000000000000000000000000000000000025c3aa4f774918d4fbe8a9854d6d820000000000000000000000000000003efeb5c04e1e842fe2e99d986d077318a60000000000000000000000000000000000220a16cb10c33d7825da201ae19e2c000000000000000000000000000000b3f781c6ebbde829c5509fd1b7b82c3bee00000000000000000000000000000000001649b837dc92371f06e43182edcbe20000000000000000000000000000003efeb5c04e1e842fe2e99d986d077318a60000000000000000000000000000000000220a16cb10c33d7825da201ae19e2c000000000000000000000000000000b3f781c6ebbde829c5509fd1b7b82c3bee00000000000000000000000000000000001649b837dc92371f06e43182edcbe20000000000000000000000000000005219ab42e453a85e5b65b12111dbd6172300000000000000000000000000000000000c8d859871dbb9d6c30d6525a207cb00000000000000000000000000000019e5d0a985483fa109f835fb599f131bba000000000000000000000000000000000026c33a0e558fea22ed3137ba888f73000000000000000000000000000000f3ec21c5ba887a06943c9bd68376778e9a000000000000000000000000000000000027c64abf1700bbb1ddbcd1777285bf000000000000000000000000000000a329646da97c90113ef9d552fd0e05ad56000000000000000000000000000000000006d7ff8c5055a681b7074494103e6e00000000000000000000000000000018402e4a004950a59cb37ac15959141b1d000000000000000000000000000000000008fcdeb7cccff0eeae6a9ded8017c20000000000000000000000000000001337214d6c0247ed01e7ab89578951e0c2000000000000000000000000000000000017f60c5209e321e893af8f4858bd900945ad731fcaf3c9f7c38f8a8b90c37ad5f71aef1c1dfd7827f3d430c86ce1ae271ea0ffc166ac5fc08cb62bf5f094e2523ccd595d9b73191bee216327931e5303c58c1fc12e1bb6b9dd1290d6ba2d8e3b8ebde03040b86eb47839c31d689527074343f2bfbefcfbaaf0d1ea8ae9c16966c49bc555e824f88e28014656930a040b4a5be7d5b383c0c8cf4256a207213abb48b8b7e0e922eaf0c0a5e7f562f5662ee7c7837bba2eeac0ed2be9999b9188c26c3f416d29df0b146da34c44baebf6144f7ef2388415019033e907adb361ef03b1ee47c2bd2e74b933843d6cbd141d0edc78b1cee4b1ef0db3a9503c7c5994beefb6b19aacc73303bd3b13914b2f7c2fa78e513281ffebf488c3068851e0b8f3daef992ca1f2f1d738413cf8b72d5c217434be63a49fceb2cdf7211cb2714e85d8951dd7ab0c4392f2939ab778c18e190b664a263ba441ccbf2d754b9adad9fd046e3234147e4e0ad454a9ece9cf55043b85dd70aea362f210e8db3a7ada21d5c3fb53da7b82584347c60da56570a42adbcf877291f00b8b44d71a32e2d620a1b7cc1468d4fd630925c08d891c95b60b2bf419408d87c081f04049abe23af567bf5e3486830e1f33f49c546056c71f2119848ac9e2e2ce90b526952a07f659df928df8c4261e4fa5c9f5e1a32fbf7b12d6eff279641f3dbfcd965f43f5366aa2794cce9802cd46153d368434976af42a59f5e9f9ba9e50a751f1acbf7340c090c292bdc62f1c0e7e485fec032adec905c0581d84d7f23bf03cec25d3155358a7a0be059d044b73318d5b56cfa1860608788930b3c21d31f0f03b5020194865fe7a419125716bbdbc0bdf3ca4b292ea17d55b20052e0858fcea81dd7791457bbb6596265b4a153abc8cb9ad662c0c25257c88ef898cd5761f941bb98b57285240db8771674ec90227bdc7218a9df85b2a374e15d42063598f05e35d8b751333181ec4922a1873da43a9698160a7623c15c357d984104ef5c2e8d54e974e00eb261d3a972356003abd38de5e74eb2d3428590b4f39374fc4437225f37894ff5aa9aaefbeff6ddcb50760f485f7e7487d12bd2322459e873f15169e52b968c297c3280db1887b0ecc78dad2192f031a4b17c07ce537f2c3740753a91c766a1bd7b7481a448568890faa1f8a2873afa7b026c8b8ef1075176a866af9c5df59db9a7ce20e9bc9401c835adb7bafd038ba8d2856f03eddeac114d7cab1bd7f337a145768ed61dfcf60d3611a7b037d24c4bb180e3683bba58bed29551449addc1dfe490720226b6c5218554330ba5e7cb7fd223b670981f10a1ee16c284522190796e84205d493313ad7e72473f237a9b1740eb91d8c4a26af9e5dd062f7a415ee7b34eef976cce8fec0767e3fd7ec3804361e3d7421e3aca5649b6b1857d3d9ebd9f27c1fcc75c9ce16866fc831559b218a1d8c522f8c51b5c734a864ee995189713c995187d78564fb04bb2e6851b5526f000dcbe678623d00e6aebcaf27532b8a091f2d873bb0f2ca67cfe72f8d87180325088f57a0d8d742e88c6ffcebe49ed4d306686ab6d8401c80362316ab120547038cafb0c926995897decf0a37ee0ead6c18180437e8f004c57d354670c101a72ef73367b79c2517296ab1a475c5ac9f96a118129282348bc0f67b0d2f91994c0b7f550732c3d9ac0a6bfcf4aee1f625d19da9bc59906a96cd2a0189474fd13a16efe93f761c59042616950740059065793451f24049bae6043f564dd41650f81c69435817d7d1220749d185cb8f4404bc03dbcb70335d563755977a27d0faba091453e88e24b33f8a6146ea1861bafed547c2eb6b62e2c4828e2dcab8e99d9012cdfd8c9f442a29e1b227f4655d4e1f8d712f96565bd0cf92afe08dd5ab20ac2ef20a0dac89d1c07aa5c45c217442a04bd9aab5a77091e6b9ef0f70f5fcad3028057749e80189e802f824aa631a19a445428c2a58c5c71df0019119095aaa79285efcb1996f3b2ffaa38ce8da7f520560d22d07ecf189dea8d9a99ae8fd5b5a03ae352f2a820adcc2fc95786aeb32b239347d2b7b7ee07d4ca53d63da4615bc1e5fcf4e6434dc803c57de5d3d0bfc1598b3a7c1321c2897edaaff0a62ec28b0166eeb0617a8421a1ac558e4555550be01163ae7f1b0a19507f77683022c60782dd219214e546b1aa2087e90c17824e2ea3c6a4f07d4ad019463408bb6df082b26c4cf4eb40a9bf691e181324a557bff99634fbde3d08b8e3b7712797aa2d29227c5e7cf887f5acec773fcb863e4462874a7ec3ea2f6709deac6640283b206e515c51e4e67004babbfaf17a18298bfdd0a6eecca318accfa5d1f0d4688fd72a80f09d004b16f9d80c1fcf64f601463c7705be4ff554b55b92ed3713d7ddd02a827ebc15ad803e035514616ae08fffb398f34e91c7471840f90c8cdc87c16edcc0d73fd9f80c28faac04b52cbe582def29eb48221d0d0d240dfbf67cdfa0502f405535a8977833963ca722b9084812d784ab4f3e760bfb2b20b9e8fab97aa01250346bf26e572b3b9ba2cfbef0760c6639e22b6ca30f2ce4fca19b0fc3c87b3d02799d3686b6b21aad496a44ef4a44f602700a5cef66037afe0cfe2e9d878cdc91cd53ca1dfbc255ee9b28f4a5dd1fb7675af1bd001b4a64b56d03023fb54257f0a7f9a8424be5e239acd032867d5ccb5d2f28b75f29395a8d284a1cf1a50676b097556a2a8571724ca2a5f55cde4214480e7468887902fa86d052dfe4d0cd09e2f9695767672fd5c01abcd5ebb9576a457d31e78271f9f916a6b4e10d87ee59f235d25dd2dfbc8191b62a4cc2c91a1c48253b50ee4d120db0f5661a71a6978e704772e9c53945b90b9ca544c49070b9c4ca233b51c48ea3787157732a76e1b44289e10a9dcabb5383b0a49e282efe3a5abb1a77177bcc0c20faa019d4cbf33791bae9b093c1b08d5bfa4d32297584cb83c551410a3c3e7f2a73d742f626e44df08095344d16a9b366abb204f8c854514618daff4ce4362902cb876fd0381296100478691a54ccb35ce72efa6d74d22c6366729e7400683ba2b5600d7dc7e9b9a2f02843f03e358a0b6229e8ac6f6a872215c225c08bb95314083ba0ca831d2e32e0037f9ca9e0250b3874cba5e573f567c7f072b80cc70627dd0d785f13c421d1b9e0b3ee3df2792cc3f6bb4efbaaf0afa7488b918b984538c664d7078fda7bd21183bbef720b2b3ad19fbfd87ab38c19187f66ece504c4439ac8e889a3c35be15e27d7bd40e53b7d9bbf36b862c34bb99ac30b9ed59da8e8f05848c056780f400cf6d0df89a322493aeb4fec64301cf53a79c42dab5f2f6b35038f731b63e402c5829014ee5a15ecb3f6f885a46f594e6444d72c563bcb58a3a189fb503d3e009af4cfe19084177d4d94963e029407199eb19406234dd055962ae8ce9b5c1252492562b767cd70e3deb6b6928b6f7e3d3dab9909cde17b9fd533676e96745020f971c967f58a4c16ebad0e434c2df5bf5ce278e736536ed07a894c1c4e497801e2277a98f44343db611a5e23ea772fbe82e34a6204246c4189dd9d9544da5dd0d9418b33d7f9ca7df79c57988c7aba29e83bfdeb70a1f73208e9c0ed6fe1b300865b0a5f39476d9caf73efcb67c421fbbd5ab9aa6d22be3ce0f6ea477052e740616a818918a0a6dbc43944de82656e3278ec3c5ef82d368af46b91c0af271fc109301fcf9e842f2d5c4ff3cf95d2af46267cd0c5586470c3ded5376a1fb0eae2e937bc1438f715b588cffc599562bd68de9e8c82a5236e111487cfaa90f13a6157de2c6ae72252d53adaec2d6a5792a172b4cd6e7fff66d89eb0a66a534c4d625fb5604443f21ee1e3c724f31cbe4e9c9a8d805c029a8c34cf64916d5c941cc11e4faedadc843c92aa16953d00123ab89f6ba05203bdb7b9f44c2140e4dcf732162fb4ace1cded05a0a2f2c38518c25972d3e3cfb2259f3d773864c88d3778700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c7182b7cdd3200fbf99ae296957fbead5804a948fc5c4e582165e86c48dc2d609cfa22d0a350e563119727720947a4b22c3d3c7e92fe62ebcfabaa877f9cf8b1b689cdaf27e0af44b28558834118490074e94f0fdab3d9137907a6e81ef23ea0e77dbcedb0ce4d0c13286180efa6f50d637b512bc8493c54b8327acc3a5ea6929a5db972336772c6896d103d667e73bea5cd4d7a44b7b9813051f453391ab66295b9d430a713b29e3bc43efcfaa28b02660787c2cc5615898ca1db1ceafd78e007a02b4784c788bf869e9e0469ab4c90d7849869d5a89da4a3f1cd2498acbb109ca0b34c63b5c03af120bfe456e97d18b7fd976bf1015ff07e4f1acea7a797322ca86ae1d867aa3bfe52a4ea6b00c07c39af8cb80215709416dcff60584a7a2199c6b7b0adec10d2fc48d25e10c620ef4b303574e48b438df1c0363d3fe2da712ad38b6eae37fc99b3f12228ca205266cac50aa864480489514fa27783d1c581ce1f4dd7651277aeb3897c14c89fbf4453d480e6af4590eeaeee5ba1401b2430a289c69e97ee4af97faa5233098a978241e7821c0251378ad95e8804c106ed60ea34f62dc68cfbdbbed5bd6c5585df8eec8f0c253117cd704460c1c482754fe2eeafb6bd33959db6c2189ea64dadb1003fda5ee209e1212ca92e20a7ccb8c401b0414d75246988df5b9c0f4db1c6e00873f59bc08c6664effea5a773c50a7331efab4948c130a9a4dacb64b26981d4560673c18cffe22d90f1660be4e7087a61cd6c91b9a74355579ea3811b3edca412dc3f42e5f32ef04b6d1834476dc6e5310ab27a9de87b4ffa80849041e1877b1de32503b3dfdb0ccce97bed85574d267061a1691288d5b42c8dce79643bfb23edeaf315c4ef2f9ebbfb798f4d2bd08ad04a93c86685f3fbb4d3d300f812f2b737048ed8b1c922dfd5de695d35c18c4191326a04235e835b7220ee75aebcc7b44693029b880a3f1740c8ed504b93a84e82b7e7f4a18b061871b7ece68eee2af96a9791be046520cad66ea657892c128142b009ae363592b254814d2c2641a3755db7a190a5f4aed3cdff42cde691e25e82573b950e5fb11b8f0f69ab2b399c48937814825d5a1d2bf73355d75cf078cf50218d3c9f582bef98284db015ab9eb3189862740b82539b2bd514f728880de28019d91a90656d83891b7b2d45b13e78f33176b5e1e1371fa7f96e8e3390a3aab2b35689aad56914de555263cb23d1ef36e963ec62457094bddf2c870d3d2e0271584f3f1d685804f1373ec2ea9d5a3dda8846a9056d1711d9fa52afedebd1dbe16b5ca56102ea8cdd31ac10dd4341430507bdd1996c504bfb2072861696d14ca0558c52c07b0c905ec37fcf3c8d6a969a443e0ab780814ad4244ac63064aecc90082f05ec37515d3ac1610ef1eafbcccb65fa37cb2f6cb062fc4b4832588e59a2bfbb2bc987b101ff49f6f1df94fba6bcd72cce23f39af8e9299c80a912ed0eb27bf46ecd9393f33bfe9c049a8ae2296d5c6fc78ea839403448d43c4792c7b2827bf46ecd9393f33bfe9c049a8ae2296d5c6fc78ea839403448d43c4792c7b28291e4114a181bb604c7d14f986b12d245b13ee3770ec13cc8e0e5f7137b6eec80da8245fe478493cbe89f45b35d7107b8276d74811aea412d211a2b9df4878230faeaf85c36d811a894b02bc3597cf2801489043cac78e5b6756a4f69d7779f420941ae71648b1994871b1d1648c2bfc120c3770c6cb1e6b342e9d43314302da15452d07dd1f65d8534cb23c6cfc85893f4713e85d5275ae267062c62663ea0a000000000000000000000000000000e866c4e3c5ca1b7e5eb11811dfe1f8b09900000000000000000000000000000000000d57f271ddf232e3db4850a97d10de000000000000000000000000000000ce72ab33f9dcefdffc9aa05005722aa7b30000000000000000000000000000000000225d7c7450d9a03913e36e688af613000000000000000000000000000000927e708ddd228171efaefd34b260aa5e1a0000000000000000000000000000000000121f063c10775ee428275c6ea977d9000000000000000000000000000000033b2340248f353defa4f280b1d52d497f0000000000000000000000000000000000274248f73ff1a6daf5e805d08312e4000000000000000000000000000000d9cff97e5b6537bb2a1ebf05cc2a9a6fe9000000000000000000000000000000000007b4635c7a82ed8ae3f979fe8c4d28000000000000000000000000000000460111abf7bc9b18283cccad1da4aa071c000000000000000000000000000000000013cb0e9ee2ba932c61e8005c7ad9b9000000000000000000000000000000756b378004856e6507c7c12c5a733b5289000000000000000000000000000000000002a72c3f9ce085e732d700c0b3e48e0000000000000000000000000000009da9df43cfb92055d2e7536763a491fcf3000000000000000000000000000000000023876fc1e465a036d0ad0b9e71ecf000000000000000000000000000000051013c4cb6a2acb01febee7d98c4ba39de0000000000000000000000000000000000035a96e589ecbf838b5a1f02c1d5ed000000000000000000000000000000ec534a8cfd14e987bf3a3accc98a2e84eb000000000000000000000000000000000010f979648b7c68e1e168269aa9574a000000000000000000000000000000a7c243f97088452e9da1b772beccb2e5db00000000000000000000000000000000000c82230cb2eeb3a3c9fc44cba5d641000000000000000000000000000000f5480fa3fa73a5fb4d7b0d2c98ba1fe5280000000000000000000000000000000000053bb56dcac3fe4051658451988c07000000000000000000000000000000c3b4875bff6bffb49d993dd4dd728fe82e00000000000000000000000000000000002a96d13dd9c6d6b07cae07a85f565200000000000000000000000000000006a54a4adae03d5b9fe83085166ba4bd1a0000000000000000000000000000000000224799f57cdb51d4160da52fb678c5000000000000000000000000000000916e50ba336c13358b84f9503fe8bd21cc00000000000000000000000000000000002807538c9f87da0ae1b1bb2bb9fbcf0000000000000000000000000000003a11f50857b533fd6f31a78d897e80c444000000000000000000000000000000000013e2ad58a11d4f86797279b9490dc500000000000000000000000000000002b7394889519e335d950274405935c4b200000000000000000000000000000000003007cca7d28f227cf67c07c9d5087f0000000000000000000000000000005f495dd0bbf102563586b12be2dbc2ccc000000000000000000000000000000000000026722558bfc03b8ac4920903efa50000000000000000000000000000001691633d275bd50a9a74e047cb2075f948000000000000000000000000000000000025d3f8ec4f99ee9c158d2ceedcb72f00000000000000000000000000000032de57e48c9eee3aad2d985127f3a95e180000000000000000000000000000000000088c5e4867f205809015fa6fbc0c86000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000b7d32e8c046996ffea5c3ebfde1d6782258bd02deea181c816951c316915c0910c00b11a4f248a5196c5cb8544dacf02c4263b12e6e3b67260b860f08cad1272744349a9e42ae1c53cc7c01d40148e257c0aff9c1c2ea61f515e85bc64bc8070358307c6004f2576bf4161372e163518a87f2d1d435a1222efa72197aa2333b09ecfa7a0c10dbcfeab31c603c6c60c280088cd73b707e59279b8ec219d2743e28f0016ef51677c8f4acc2b600a6199b4df9977f3c328c2522f0aea506d878b72f5b4521ef734dba292df5e92f205a289e6eeba8f9328966f01d1688017168251c80ea610dad443e396b64162c0fa41c3088388407dcd80c8cfe06f34e78e55304af95f7a04b6252da6e93ed62234fdc35716bb8f19f6364f4f3c2e97c98731e1ff4305261a563e08d9adf14e2a6622e9b05a8aac5e33eabd8008a74057cc6371c3e40337faea57b44c93c50d13de894cd7ac37b61dd0d294fdaa581ba158a9600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fd0d598e16be911c514d5b2caa0d9a885d0000000000000000000000000000000000204c13aeed7f15e5fe96d498d841a1000000000000000000000000000000465c498ec5d89b3c6f936f98b825c6a92b0000000000000000000000000000000000179a6ca40ca51be7a9d0ab961fcfc700000000000000000000000000000007f4d7d6fd3b9343f66f303466bddc0bb600000000000000000000000000000000002fa1f9d6b3371df5f3630a5448021f00000000000000000000000000000004d1e1158a6a269563d441706fcce1dd3c000000000000000000000000000000000029a007922eef31f735c603aba338cb",
    //   "0x29768a817f409a020e49304cb11c8f6d708d89ab7ce792bfb40717240c47a47e",
    //   "0x180dac8d236381b89b3604d5611efc48c7f3f6f556ecfc99c24320e7aa9aaa98",
    //   "0xE959A2c1c3F108697c244b98C71803b6DcD77764",
    // ];

    const dynamicArguments = [
      convertProofToBytes(proof),
      merkleRoot,
      nullifierHash.toString(),
      address,
    ];

    // console.log({ testArguments7, dynamicArguments });

    const writeContractInfo = {
      abi,
      address: ZK_MIXER_CONTRACT as `0x${string}`,
      functionName: "withdraw",
      args: dynamicArguments,
    };

    try {
      const simulationResponse = await simulateContract(
        config,
        writeContractInfo
      );
      console.log({ simulationResponse });
    } catch (err) {
      setWithdrawErrMsg("Failed to simulate transaction");
      console.error(err);
    }

    try {
      await writeContractAsync(writeContractInfo);
      setProofGenerationInfo("withdrawn successfully");
    } catch (err) {
      setProofGenerationInfo("Failed to withdraw");
      console.error(err);
    }
  }

  return (
    <div className=" flex gap-4 flex-col justify-center items-center  rounded-2xl p-5 shadow-lg ring-2 w-3/4 ">
      {isWithdraw ? (
        <div className="flex gap-4 flex-col justify-center items-center">
          <input
            onChange={(e) => {
              setEncodedProof(e.target.value);
            }}
            autoFocus={true}
            className="w-full px-4 py-2 text-lg text-gray-700 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-center"
            type="text"
          />
          <div
            onClick={handleWithdraw}
            className=" bg-green-500 rounded-[5px] text-center p-2 px-6 min-w-32 cursor-pointer"
          >
            {isPending ? "Initiating withdrawl..." : "Withdraw"}
          </div>
          {withdrawErrMsg && (
            <div className=" text-red-500 text-center">{withdrawErrMsg}</div>
          )}
          {error && (error as CustomError).cause?.details && (
            <div className="text-red-500 text-center">
              {(error as CustomError).cause?.details}
            </div>
          )}
          {proofGenerationInfo && (
            <div className=" text-green-500 text-center">
              {proofGenerationInfo}
            </div>
          )}
          <div
            onClick={() => setIsWithdraw(false)}
            className=" bg-blue-500 rounded-[5px] text-center p-2 px-6 min-w-32 cursor-pointer "
          >
            Switch to deposit
          </div>
        </div>
      ) : (
        <div className="flex gap-4 flex-col justify-center items-center">
          <div
            onClick={handleDeposit}
            className=" bg-blue-500 rounded-[5px] text-center p-2 px-6 min-w-32 cursor-pointer h-10 "
          >
            {isPending ? "Initiating..." : "Deposit 0.0001 ETH"}
          </div>
          {depositErrMsg && (
            <div className=" text-red-500 text-center">{depositErrMsg}</div>
          )}
          {error && (error as CustomError).cause?.details && (
            <div className="text-red-500 text-center">
              {(error as CustomError).cause?.details}
            </div>
          )}
          {isConfirmaing && (
            <div className=" text-yellow-500">
              Transaction is processing... 
            </div>
          )}
          {isConfirmed && (
            <div className=" text-green-500 flex flex-col gap-3 items-center">
              Transaction success , withdraw after 24 hours
              {note && (
                <div className=" flex items-center flex-col gap-2 py-2 text-center text-purple-500 pr-3 border-2 border-purple-500 rounded-2xl">
                  {note}
                  <span
                    onClick={handleCopy}
                    className="p-1 cursor-pointer border-2 rounded-xl font-extrabold text-black"
                  >
                    {copied ? "COPIED" : "COPY"}
                  </span>
                </div>
              )}
            </div>
          )}
          {txError && (
            <div className=" text-red-500 text-center">
              Sumitted transaction failed
            </div>
          )}
          <div
            onClick={() => setIsWithdraw(true)}
            className=" bg-green-500 rounded-[5px] text-center p-2 px-6 min-w-32 cursor-pointer"
          >
            have proof , Withdraw here
          </div>
        </div>
      )}
      <div className=" mt-4 text-sm text-slate-500">
        {" "}
        Contract you are interacting with ::{" "}
        <Link
          className=" font-bold text-blue-400 underline"
          href={SEPOLIA_EXPLORER + ZK_MIXER_CONTRACT}
          target="_blank"
        >
          {ZK_MIXER_CONTRACT}
        </Link>
      </div>
    </div>
  );
}
